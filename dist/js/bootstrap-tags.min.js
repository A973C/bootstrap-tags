/*!
 * bootstrap-tags 1.0.0
 * https://github.com/maxwells/bootstrap-tags
 * Copyright 2013 Max Lahey; Licensed MIT
 */

!function(a){!function(){window.Tags||(window.Tags={}),jQuery(function(){return a.tags=function(b,c){var d,e,f,g,h,i,j,k=this;null==c&&(c={});for(d in c)g=c[d],this[d]=g;if(this.bootstrapVersion||(this.bootstrapVersion="3"),this.readOnly||(this.readOnly=!1),this.suggestions||(this.suggestions=[]),this.restrictTo=null!=c.restrictTo?c.restrictTo.concat(this.suggestions):!1,this.exclude||(this.exclude=!1),this.displayPopovers=null!=c.popovers?!0:null!=c.popoverData,this.popoverTrigger||(this.popoverTrigger="hover"),this.tagClass||(this.tagClass="btn-info"),this.tagSize||(this.tagSize="md"),this.promptText||(this.promptText="Enter tags..."),this.caseInsensitive||(this.caseInsensitive=!1),this.readOnlyEmptyMessage||(this.readOnlyEmptyMessage="No tags to display..."),this.beforeAddingTag||(this.beforeAddingTag=function(){}),this.afterAddingTag||(this.afterAddingTag=function(){}),this.beforeDeletingTag||(this.beforeDeletingTag=function(){}),this.afterDeletingTag||(this.afterDeletingTag=function(){}),this.definePopover||(this.definePopover=function(a){return'associated content for "'+a+'"'}),this.excludes||(this.excludes=function(){return!1}),this.tagRemoved||(this.tagRemoved=function(){}),this.pressedReturn||(this.pressedReturn=function(){}),this.pressedDelete||(this.pressedDelete=function(){}),this.pressedDown||(this.pressedDown=function(){}),this.pressedUp||(this.pressedUp=function(){}),this.$element=a(b),null!=c.tagData?this.tagsArray=c.tagData:(f=a(".tag-data",this.$element).html(),this.tagsArray=null!=f?f.split(","):[]),c.popoverData)this.popoverArray=c.popoverData;else for(this.popoverArray=[],j=this.tagsArray,h=0,i=j.length;i>h;h++)e=j[h],this.popoverArray.push(null);return this.getTags=function(){return k.tagsArray},this.getTagsContent=function(){return k.popoverArray},this.getTagsWithContent=function(){var a,b,c,d;for(a=[],b=c=0,d=k.tagsArray.length-1;d>=0?d>=c:c>=d;b=d>=0?++c:--c)a.push({tag:k.tagsArray[b],content:k.popoverArray[b]});return a},this.getTag=function(a){var b;return b=k.tagsArray.indexOf(a),b>-1?k.tagsArray[b]:null},this.getTagWithContent=function(a){var b;return b=k.tagsArray.indexOf(a),{tag:k.tagsArray[b],content:k.popoverArray[b]}},this.hasTag=function(a){return k.tagsArray.indexOf(a)>-1},this.removeTagClicked=function(b){return"A"===b.currentTarget.tagName&&(k.removeTag(a("span",b.currentTarget.parentElement).html()),a(b.currentTarget.parentNode).remove()),k},this.removeLastTag=function(){return k.removeTag(k.tagsArray[k.tagsArray.length-1]),k},this.removeTag=function(a){if(k.tagsArray.indexOf(a)>-1){if(k.beforeDeletingTag(a)===!1)return;k.popoverArray.splice(k.tagsArray.indexOf(a),1),k.tagsArray.splice(k.tagsArray.indexOf(a),1),k.renderTags(),k.afterDeletingTag(a)}return k},this.addTag=function(a){var b;if((k.restrictTo===!1||-1!==k.restrictTo.indexOf(a))&&k.tagsArray.indexOf(a)<0&&a.length>0&&(k.exclude===!1||-1===k.exclude.indexOf(a))&&!k.excludes(a)){if(k.beforeAddingTag(a)===!1)return;b=k.definePopover(a),k.popoverArray.push(b||null),k.tagsArray.push(a),k.afterAddingTag(a),k.renderTags()}return k},this.addTagWithContent=function(a,b){if((k.restrictTo===!1||-1!==k.restrictTo.indexOf(a))&&k.tagsArray.indexOf(a)<0&&a.length>0){if(k.beforeAddingTag(a)===!1)return;k.tagsArray.push(a),k.popoverArray.push(b),k.afterAddingTag(a),k.renderTags()}return k},this.renameTag=function(a,b){return k.tagsArray[k.tagsArray.indexOf(a)]=b,k.renderTags(),k},this.setPopover=function(a,b){return k.popoverArray[k.tagsArray.indexOf(a)]=b,k.renderTags(),k},this.keyDownHandler=function(a){var b,c;switch(b=null!=a.keyCode?a.keyCode:a.which){case 13:return k.pressedReturn(a),e=a.target.value,-1!==k.suggestedIndex&&(e=k.suggestionList[k.suggestedIndex]),k.addTag(e),a.target.value="",k.renderTags(),k.hideSuggestions();case 46:case 8:if(k.pressedDelete(a),""===a.target.value&&k.removeLastTag(),1===a.target.value.length)return k.hideSuggestions();break;case 40:if(k.pressedDown(a),""!==k.input.val()||-1!==k.suggestedIndex&&null!=k.suggestedIndex||k.makeSuggestions(a,!0),c=k.suggestionList.length,k.suggestedIndex=k.suggestedIndex<c-1?k.suggestedIndex+1:c-1,k.selectSuggested(k.suggestedIndex),k.suggestedIndex>=0)return k.scrollSuggested(k.suggestedIndex);break;case 38:if(k.pressedUp(a),k.suggestedIndex=k.suggestedIndex>0?k.suggestedIndex-1:0,k.selectSuggested(k.suggestedIndex),k.suggestedIndex>=0)return k.scrollSuggested(k.suggestedIndex);break;case 9:case 27:return k.hideSuggestions(),k.suggestedIndex=-1}},this.keyUpHandler=function(a){var b;return b=null!=a.keyCode?a.keyCode:a.which,40!==b&&38!==b&&27!==b?k.makeSuggestions(a,!1):void 0},this.getSuggestions=function(b,c){var d=this;return this.caseInsensitive&&(b=b.toLowerCase()),this.suggestionList=[],a.each(this.suggestions,function(a,e){var f;return f=d.caseInsensitive?e.substring(0,b.length):e.substring(0,b.length).toLowerCase(),d.tagsArray.indexOf(e)<0&&f===b&&(b.length>0||c)?d.suggestionList.push(e):void 0}),this.suggestionList},this.makeSuggestions=function(b,c){var d;return d=null!=b.target.value?b.target.value:b.target.textContent,k.suggestedIndex=-1,k.$suggestionList.html(""),a.each(k.getSuggestions(d,c),function(a,b){return k.$suggestionList.append(k.template("tags_suggestion",{suggestion:b}))}),k.$(".tags-suggestion").mouseover(k.selectSuggestedMouseOver),k.$(".tags-suggestion").click(k.suggestedClicked),k.suggestionList.length>0?k.showSuggestions():k.hideSuggestions()},this.suggestedClicked=function(a){return e=a.target.textContent,-1!==k.suggestedIndex&&(e=k.suggestionList[k.suggestedIndex]),k.addTag(e),k.input.val(""),k.makeSuggestions(a,!1),k.input.focus(),k.hideSuggestions()},this.hideSuggestions=function(){return k.$(".tags-suggestion-list").css({display:"none"})},this.showSuggestions=function(){return k.$(".tags-suggestion-list").css({display:"block"})},this.selectSuggestedMouseOver=function(b){return a(".tags-suggestion").removeClass("tags-suggestion-highlighted"),a(b.target).addClass("tags-suggestion-highlighted"),a(b.target).mouseout(k.selectSuggestedMousedOut),k.suggestedIndex=k.$(".tags-suggestion").index(a(b.target))},this.selectSuggestedMousedOut=function(b){return a(b.target).removeClass("tags-suggestion-highlighted")},this.selectSuggested=function(b){var c;return a(".tags-suggestion").removeClass("tags-suggestion-highlighted"),c=k.$(".tags-suggestion").eq(b),c.addClass("tags-suggestion-highlighted")},this.scrollSuggested=function(a){var b,c,d,e;return c=k.$(".tags-suggestion").eq(a),d=k.$(".tags-suggestion").eq(0),b=c.position(),e=d.position(),null!=b?k.$(".tags-suggestion-list").scrollTop(b.top-e.top):void 0},this.adjustInputPosition=function(){var b,c,d,e,f,g;return f=k.$(".tag").last(),g=f.position(),c=null!=g?g.left+f.outerWidth(!0):0,d=null!=g?g.top:0,e=k.$element.width()-c,a(".tags-input",k.$element).css({paddingLeft:Math.max(c,0),paddingTop:Math.max(d,0),width:e}),b=null!=g?g.top+f.outerHeight(!0):22,k.$element.css({paddingBottom:b-k.$element.height()})},this.renderTags=function(){var b;return b=k.$(".tags"),b.html(""),k.input.attr("placeholder",0===k.tagsArray.length?k.promptText:""),a.each(k.tagsArray,function(c,d){return d=a(k.formatTag(c,d)),a("a",d).click(k.removeTagClicked),a("a",d).mouseover(k.toggleCloseColor),a("a",d).mouseout(k.toggleCloseColor),k.displayPopovers&&k.initializePopoverFor(d,k.tagsArray[c],k.popoverArray[c]),b.append(d)}),k.adjustInputPosition()},this.renderReadOnly=function(){var b;return b=k.$(".tags"),b.html(0===k.tagsArray.length?k.readOnlyEmptyMessage:""),a.each(k.tagsArray,function(c,d){return d=a(k.formatTag(c,d,!0)),k.displayPopovers&&k.initializePopoverFor(d,k.tagsArray[c],k.popoverArray[c]),b.append(d)})},this.initializePopoverFor=function(b,d,e){return c={title:d,content:e,placement:"bottom"},"hoverShowClickHide"===k.popoverTrigger?(a(b).mouseover(function(){return a(b).popover("show"),a(".tag").not(b).popover("hide")}),a(document).click(function(){return a(b).popover("hide")})):c.trigger=k.popoverTrigger,a(b).popover(c)},this.toggleCloseColor=function(b){var c,d;return d=a(b.currentTarget),c=d.css("opacity"),c=.8>c?1:.6,d.css({opacity:c})},this.formatTag=function(a,b,c){var d;return null==c&&(c=!1),d=b.replace("<","&lt;").replace(">","&gt;"),k.template("tag",{tag:d,tagClass:k.tagClass,isPopover:k.displayPopovers,isReadOnly:c,tagSize:k.tagSize})},this.addDocumentListeners=function(){return a(document).mouseup(function(a){var b;return b=k.$(".tags-suggestion-list"),0===b.has(a.target).length?k.hideSuggestions():void 0})},this.template=function(a,b){return Tags.Templates.Template(this.getBootstrapVersion(),a,b)},this.$=function(b){return a(b,this.$element)},this.getBootstrapVersion=function(){return Tags.bootstrapVersion||this.bootstrapVersion},this.initializeDom=function(){return this.$element.append(this.template("tags_container"))},this.init=function(){return this.$element.addClass("bootstrap-tags").addClass("bootstrap-"+this.getBootstrapVersion()),this.initializeDom(),this.readOnly?(this.renderReadOnly(),this.removeTag=function(){},this.removeTagClicked=function(){},this.removeLastTag=function(){},this.addTag=function(){},this.addTagWithContent=function(){},this.renameTag=function(){},this.setPopover=function(){}):(this.input=a(this.template("input",{tagSize:this.tagSize})),this.input.keydown(this.keyDownHandler),this.input.keyup(this.keyUpHandler),this.$element.append(this.input),this.$suggestionList=a(this.template("suggestion_list")),this.$element.append(this.$suggestionList),this.renderTags(),this.addDocumentListeners())},this.init(),this},a.fn.tags=function(b){var c,d;return d={},c="number"==typeof b?b:-1,this.each(function(e,f){var g;return g=a(f),null==g.data("tags")&&g.data("tags",new a.tags(this,b)),c===e||0===e?d=g.data("tags"):void 0}),d}})}.call(this),function(){window.Tags||(window.Tags={}),Tags.Helpers||(Tags.Helpers={}),Tags.Helpers.addPadding=function(a,b,c){return null==b&&(b=1),null==c&&(c=!0),c?0===b?a:Tags.Helpers.addPadding("&nbsp"+a+"&nbsp",b-1):a}}.call(this),function(){window.Tags||(window.Tags={}),Tags.AutoSuggestTerms=function(){function a(){}return a}()}.call(this),function(){window.Tags||(window.Tags={}),Tags.Tag=function(){function a(){}return a.prototype.initialize=function(a,b){return this.name=a,this.popoverContent=b},a.prototype.render=function(){return this.$el.html(this.template)},a}()}.call(this),function(){window.Tags||(window.Tags={}),Tags.TagsCollection=function(){function b(){}return b.prototype.initialize=function(b){var c,d,e,f;for(null==b&&(b={}),this.tags=[],this.excludeList=b.excludeList||[],this.excludeFunction=b.excludeFunction||function(){return!1},this.restrictionList=b.restrictionList||[],f=b.tagObjects,d=0,e=f.length;e>d;d++)c=f[d],this.addTag(c.name,c.popoverContent);return this.$el=a(this.template("tags_container")),this.el=this.$el[0]},b.prototype.addTag=function(a,b){return this.tags.push(new Tags.Tag(a,b))},b.prototype.hasTag=function(a){var b,c,d,e;for(e=this.tags,c=0,d=e.length;d>c;c++)if(b=e[c],b.name===a)return!0;return!1},b.prototype.getTag=function(a){return this.hasTag(a)?a:null},b.prototype.excludesTagByRestriction=function(a){return this.restrictionList.length>0&&this.restrictionList.indexOf(a)>-1},b.prototype.excludesTag=function(a){return this.excludeList.indexOf(a)>-1||this.excludeFunction(a)||this.excludesTagByRestriction(a)},b.prototype.canAddTag=function(a){return!excludesTag(a)&&!excludesTagByRestriction(a)},b.prototype.renameTag=function(a,b){var c,d,e,f,g;for(f=this.tags,g=[],d=0,e=f.length;e>d;d++)c=f[d],c.name===a?g.push(c.name=b):g.push(void 0);return g},b.prototype.setPopoverContent=function(a,b){var c,d,e,f,g;for(f=this.tags,g=[],d=0,e=f.length;e>d;d++)c=f[d],c.name===a?g.push(c.popoverContent=b):g.push(void 0);return g},b.prototype.removeTags=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(this.removeTag(b));return e},b.prototype.removeTag=function(a){var b,c,d,e,f,g;for(c=-1,g=this.tags,b=e=0,f=g.length;f>e;b=++e)d=g[b],d.name===a&&(c=b);return c>-1?this.tags.splice(c,1):void 0},b.prototype.removeLastTag=function(){return this.removeTag(this.tags[this.tags.length-1].name)},b.prototype.renderTags=function(){var a,b,c,d,e;for(d=this.tags,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.$el.append(a.render().el));return e},b.prototype.render=function(){return this.$el.append},b}()}.call(this),function(){var a,b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};window.Tags||(window.Tags={}),(a=window.Tags).Views||(a.Views={}),Tags.Views.AutoSuggestView=function(a){function c(){return b=c.__super__.constructor.apply(this,arguments)}return d(c,a),c.prototype.tagName="ul",c.prototype.className="tags-suggestion-list dropdown-menu",c.prototype.render=function(){return this},c}(Backbone.View)}.call(this),function(){var a,b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};window.Tags||(window.Tags={}),(a=window.Tags).Views||(a.Views={}),Tags.Views.TagView=function(a){function c(){return b=c.__super__.constructor.apply(this,arguments)}return d(c,a),c.prototype.className="tag label",c.prototype.render=function(){return this.$el.addClass(this.options.tagClass).addClass(this.options.tagSize),this.options.displayPopover?this.$el.attr("rel","popover"):void 0},c}(Backbone.View)}.call(this),function(){var b,c=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};window.Tags||(window.Tags={}),(b=window.Tags).Views||(b.Views={}),Tags.Views.TaggerView=function(b){function d(b,d){null==d&&(d={}),this.keyUpHandler=c(this.keyUpHandler,this),this.keyDownHandler=c(this.keyDownHandler,this),this.$el=a(b),this.el=b,a.extend(this.options={},this.defaultOptions,d),Tags.bootstrapVersion||(Tags.bootstrapVersion=this.options.bootstrapVersion),this.tagsCollection=new Tags.TagsCollection({excludeList:this.exclude,excludeFunction:this.excludes,restrictionList:this.restrictTo}),this.tagViews=[],this.render()}return e(d,b),d.prototype.template=JST["templates/tagger"],d.prototype.events={"keydown input":"keyDownHandler","keyup input":"keyUpHandler"},d.prototype.log=function(){return alert("clicked")},d.prototype.defaultOptions={bootstrapVersion:"3",readOnly:!1,suggestions:[],restrictTo:[],exclude:[],displayPopovers:!0,popoverTrigger:"hover",tagClass:"btn-info",tagSize:"md",promptText:"Enter tags...",caseInsensitive:!1,readOnlyEmptyMessage:"No tags to display...",beforeAddingTag:function(){},afterAddingTag:function(){},beforeDeletingTag:function(){},afterDeletingTag:function(){},definePopover:function(a){return'associated content for "'+a+'"'},excludes:function(){return!1},tagRemoved:function(){},pressedReturn:function(){},pressedDelete:function(){},pressedDown:function(){},pressedUp:function(){}},d.prototype.keyDownHandler=function(a){var b;return b=null!=a.keyCode?a.keyCode:a.which,console.log("doing something")},d.prototype.keyUpHandler=function(a){var b;return b=null!=a.keyCode?a.keyCode:a.which,40!==b&&38!==b&&27!==b?this.makeSuggestions(a,!1):void 0},d.prototype.getInputSize=function(){if("3"===Tags.bootstrapVersion)return this.options.tagSize;switch(this.options.tagSize){case"sm":return"small";case"md":return"medium";case"lg":return"large"}},d.prototype.render=function(){return this.$el.html(this.template({tagSize:this.getInputSize()})),this.$el.addClass("bootstrap-tags").addClass("bootstrap-"+Tags.bootstrapVersion),this.$el.append((new Tags.Views.AutoSuggestView).render().el),this.delegateEvents(),this},d}(Backbone.View)}.call(this),function(){var a;window.Tags||(window.Tags={}),(a=window.Tags).Views||(a.Views={}),Tags.Views.TagsCollectionView=function(){function a(){}return a}()}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["2"]||(a["2"]={}),Tags.Templates["2"].input=function(a){var b;return null==a&&(a={}),b=function(){switch(a.tagSize){case"sm":return"small";case"md":return"medium";case"lg":return"large"}}(),"<input type='text' class='tags-input input-"+b+"' />"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["2"]||(a["2"]={}),Tags.Templates["2"].tag=function(a){return null==a&&(a={}),"<div class='tag label "+a.tagClass+" "+a.tagSize+"' "+(a.isPopover?"rel='popover'":"")+">    <span>"+Tags.Helpers.addPadding(a.tag,2,a.isReadOnly)+"</span>    "+(a.isReadOnly?"":"<a><i class='remove icon-remove-sign icon-white' /></a>")+"  </div>"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["3"]||(a["3"]={}),Tags.Templates["3"].input=function(a){return null==a&&(a={}),"<input type='text' class='form-control tags-input input-"+a.tagSize+"' />"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates)["3"]||(a["3"]={}),Tags.Templates["3"].tag=function(a){return null==a&&(a={}),"<div class='tag label "+a.tagClass+" "+a.tagSize+"' "+(a.isPopover?"rel='popover'":"")+">    <span>"+Tags.Helpers.addPadding(a.tag,2,a.isReadOnly)+"</span>    "+(a.isReadOnly?"":"<a><i class='remove glyphicon glyphicon-remove-sign glyphicon-white' /></a>")+"  </div>"}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates).shared||(a.shared={}),Tags.Templates.shared.suggestion_list=function(a){return null==a&&(a={}),'<ul class="tags-suggestion-list dropdown-menu"></ul>'}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates).shared||(a.shared={}),Tags.Templates.shared.tags_container=function(a){return null==a&&(a={}),'<div class="tags"></div>'}}.call(this),function(){var a;window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),(a=Tags.Templates).shared||(a.shared={}),Tags.Templates.shared.tags_suggestion=function(a){return null==a&&(a={}),"<li class='tags-suggestion'>"+a.suggestion+"</li>"}}.call(this),function(){window.Tags||(window.Tags={}),Tags.Templates||(Tags.Templates={}),Tags.Templates.Template=function(a,b,c){return null!=Tags.Templates[a]&&null!=Tags.Templates[a][b]?Tags.Templates[a][b](c):Tags.Templates.shared[b](c)}}.call(this)}(window.jQuery);